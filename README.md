# YDB Phone Verification Gateway

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–∞–π—Ç–æ–≤ –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º —Å —Å–∏—Å—Ç–µ–º–æ–π –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Yandex Database.

## üìë –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
   [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
   [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∞–π—Ç–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–∞–π—Ç–∞)
   [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
   [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
- [–ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã](#–ø–æ–ª–Ω—ã–π-–ø—Ä–æ—Ü–µ—Å—Å-—Ä–∞–±–æ—Ç—ã)

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú—É–ª—å—Ç–∏—Å–∞–π—Ç–æ–≤–æ—Å—Ç—å**: –û–¥–∏–Ω —Å–µ—Ä–≤–∏—Å –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–∞–π—Ç–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
- **–°–∏—Å—Ç–µ–º–∞ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞**: –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ verification keys
- **–ü—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**: Tilda, Telegram, WhatsApp, –≤–µ–±-—Ñ–æ—Ä–º—ã
- **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –Ω–æ–º–µ—Ä–∞ –∫–ª–∏–µ–Ω—Ç—É
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YDB**: –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Yandex Database
- **Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ endpoint-—ã
- **Connection pooling**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∫ –ë–î
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—É–∫**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ —Å–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–∞–π—Ç–∞–º–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:

- **Verification Key** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∞–π—Ç–∞/–∫–ª–∏–µ–Ω—Ç–∞
- **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–ª—é—á–∞–º
- **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ webhook-—ã** - –æ—Ç–¥–µ–ª—å–Ω—ã–µ endpoint-—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- **–û–±—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –µ–¥–∏–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Node.js** - —Å—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **YDB SDK** - —Ä–∞–±–æ—Ç–∞ —Å Yandex Database
- **HTTPS** - webhook-–∑–∞–ø—Ä–æ—Å—ã
- **Serverless** - —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Yandex Cloud Functions)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∞–π—Ç–∞

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∞—à —Å–∞–π—Ç https://functions.yandexcloud.net/yandex.cloud-key?key=your_key

–§–æ—Ä–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –∫–ª—é—á—É

–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ—Ç –∂–µ –∫–ª—é—á

–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π webhook

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

**raw_submissions** - —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –∫–ª—é—á—É

**webhook_endpoints** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è webhook-–æ–≤ –ø–æ –∫–ª—é—á–∞–º

**incoming_verification_attempts** - –ª–æ–≥–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–¢–∞–±–ª–∏—Ü–∞ –≤–µ–±—Ö—É–∫–æ–≤ (–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è endpoint-–æ–≤ –ø–æ –∫–ª—é—á–∞–º)

CREATE TABLE webhook_endpoints (
    key Utf8,
    endpoint_url Utf8,
    enabled Bool,
    created_at Timestamp,
    PRIMARY KEY (key)
);

–¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º Tilda (—Å–æ—Ö—Ä–∞–Ω—è–µ–º –í–°–ï –¥–∞–Ω–Ω—ã–µ)

CREATE TABLE raw_submissions (
    id Utf8,
    timestamp Timestamp,
    phone Utf8,
    source Utf8,
    raw_data Json,
    verification_key Utf8,
    phone_verified Bool,
    webhook_sent Bool,
    PRIMARY KEY (id)
);

–¢–∞–±–ª–∏—Ü–∞ –ª–æ–≥–æ–≤ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∏–∑ –¢–ì/WA

CREATE TABLE incoming_verification_attempts (
    id Utf8,
    timestamp Timestamp,
    phone Utf8,
    source Utf8,
    verified Bool,
    found_in_submissions Bool,
    status Utf8,
    PRIMARY KEY (id)
);

–°–≥–µ–Ω–∏—Ä–∏—Ä—É–π—Ç–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–ª—é—á (–¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é 73ce67a0c48338cd36b0e63d9b5736f9)

**–ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook endpoint –≤ YDB**

sql

INSERT INTO webhook_endpoints (key, endpoint_url, enabled) 
VALUES ('73ce67a0c48338cd36b0e63d9b5736f9', 'https://your-site.com/webhook', true);

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±—Ö—É–∫ –≤ –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¢–∏–ª—å–¥–∞ https://functions.yandexcloud.net/–≤–∞—à-–∫–ª—é—á-–≤-yandex-cloud?key=73ce67a0c48338cd36b0e63d9b5736f9

–°–∞–π—Ç A ‚Üí Key: "abc123" ‚Üí –î–∞–Ω–Ω—ã–µ –≤ YDB ‚Üí Webhook –¥–ª—è —Å–∞–π—Ç–∞ A
–°–∞–π—Ç B ‚Üí Key: "def456" ‚Üí –î–∞–Ω–Ω—ã–µ –≤ YDB ‚Üí Webhook –¥–ª—è —Å–∞–π—Ç–∞ B

## –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

### **–≠—Ç–∞–ø 1: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –Ω–∞ –≤–∞—à–µ–º —Å–∞–π—Ç–µ

- –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –≤–∞—à –≤–µ–±—Ö—É–∫ URL —Å –∫–ª—é—á–æ–º –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ

- –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ YDB —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –≤–∞—à–µ–º—É –∫–ª—é—á—É

### **–≠—Ç–∞–ø 2: –ò–Ω–∏—Ü–∏–∞—Ü–∏—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏**

- –í—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ Telegram/WhatsApp

### **–≠—Ç–∞–ø 3: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–æ–º–µ—Ä

- –°–µ—Ä–≤–∏—Å –Ω–∞—Ö–æ–¥–∏—Ç –∏—Å—Ö–æ–¥–Ω—É—é –∑–∞—è–≤–∫—É –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –∫–ª—é—á—É

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∑–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∏–Ω—É—Ç

### **–≠—Ç–∞–ø 4: –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

- –í—Å–µ –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã + –∫—É–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –≤–∞—à webhook (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã webhook_endpoints)

- –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ "–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ"

- –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –≤–∞—à–µ–π CRM
